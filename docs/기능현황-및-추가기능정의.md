# ROIMSG 기능 현황 및 추가 구현 정의

본 문서는 멀티테넌트 메신저 플랫폼인 ROIMSG 프로젝트의 현재 구현 상태를 점검하고, 주요 업무 영역(테넌트 관리, 채팅, 게시판, 자료실, 회원관리, 공통 모듈)별로 추가 구현이 필요한 세부 기능을 정리한다. 각 항목은 코드 베이스와 프런트엔드 화면을 기반으로 검토하였다.

## 1. 테넌트 및 멀티테넌시

### 구현 현황
- `backend/auth-service/src/main/java/com/roimsg/auth/entity/Tenant.java` 에 테넌트 도메인 모델과 구독 플랜 필드가 정의되어 있으며, `TenantRepository` 수준의 조회 로직이 제공된다.
- `backend/common-starter/src/main/java/com/roimsg/common/tenant/TenantFilter.java` 의 헤더 기반 테넌트 컨텍스트 전파와 `BaseEntity` 의 `tenant_id` 컬럼 정의로 멀티테넌시 스키마 기반은 구축되어 있다.
- JWT 토큰 내 테넌트 식별자를 포함하여 서비스별 컨트롤러에서 테넌트/사용자 ID를 추출하는 기본 뼈대가 존재한다.

### 추가 구현 필요사항
- 테넌트 CRUD 및 구독 관리 API/화면을 제공하는 `TenantService`/`TenantController` 신설 및 관리 콘솔 구축.
- 사용자 가입 시 신규 테넌트를 발급하거나 기존 테넌트에 소속시키는 수명주기 로직 통합(테넌트-사용자 할당, 최대 사용자 수 검증 등).
- `BaseEntity` 또는 JPA 이벤트 리스너에서 `TenantContext` 값을 자동으로 주입해 누락되는 `tenant_id` 저장을 방지하고, 미설정 시 예외 처리.
- 서비스 간 테넌트 헤더 누락/위조 방지를 위한 게이트웨이 수준의 강제 검증과 로깅, 감사 추적 기능.
- 통합 환경설정: 테넌트별 파일 저장 경로 분리, 메시지 큐/캐시 파티셔닝, 테넌트별 요금제 제한(예: 메시지/파일 용량 상한) 로직.

## 2. 채팅 / 메시지 서비스

### 구현 현황
- `backend/message-service/src/main/java/com/roimsg/message/controller/MessageController.java` 에서 1:1 메시지 전송 및 특정 상대와의 대화 내역 조회 API를 제공한다.
- `Message` 엔티티는 테넌트/발신자/수신자/본문/생성일 필드를 보유하며, `MessageRepository` 는 단일 대화(conversation) 조회 쿼리를 제공한다.
- 프런트엔드 `frontend/web-app/src/views/messages/MessageListView.vue` 는 채팅방 목록/메시지 입력 UI 골격을 갖추고 있으나, 현재는 하드코딩된 더미 데이터를 사용한다.

### 추가 구현 필요사항
- WebSocket/STOMP 기반의 실시간 메시지 스트리밍, 읽음/미확인 카운트, 타이핑 인디케이터 등 실시간 기능을 위한 인프라 구성.
- 대화방(1:1, 그룹, 공지) 관리 API, 참여자 목록, 대화방 검색/고정/차단 기능 및 대화방 리스트 제공 엔드포인트 구현.
- 파일/이미지/링크/이모티콘 등 메시지 첨부, 메시지 수정·삭제, 신고·필터링, 대량 전송(브로드캐스트) 정책 마련.
- 멀티테넌트 감시: 테넌트 경계 밖 사용자 간 메시지 전송 차단, 메시지 저장 시 `tenant_id` 누락 검증.
- 프런트엔드에서 `messageApi` 와 실제 API 응답 구조를 정합화하고, 대화방/메시지 상태를 Pinia 스토어로 관리하도록 교체.
- 메시지 보관 정책(보관 기간, 백업/아카이빙), 검색/필터(키워드, 기간, 첨부유형) 및 감사 로그 제공.

## 3. 게시판 서비스

### 구현 현황
- `backend/board-service/src/main/java/com/roimsg/board/controller/PostController.java` 는 JWT 검증 후 테넌트별 게시글 목록 조회와 게시글 작성 API를 제공한다.
- `Post` 엔티티는 공지 여부, 비밀글, 댓글 허용, 조회수/좋아요 카운터 필드를 포함하나 갱신 로직은 미구현 상태이다.
- 프런트엔드 `frontend/web-app/src/views/board/*.vue` 는 Toast UI Grid 기반 목록, 작성/수정/상세 화면 골격을 갖고 있으나 백엔드와의 실제 통신은 최소화되어 있다.

### 추가 구현 필요사항
- 게시글 상세 조회, 수정, 삭제 API 및 권한(작성자/관리자) 검증 로직 구현.
- 댓글/답글, 공지/말머리, 태그, 즐겨찾기, 투표, 설문 등 협업 기능과 게시글 이력(버전) 보관.
- 첨부파일/미디어 업로드 연동, 썸네일/미리보기, 게시글 내 에디터(서식/이미지) 통합.
- 검색(제목/본문/작성자/기간), 필터, 정렬, 페이지네이션, 다중 게시판(부서/프로젝트) 구성 및 접근 권한 매트릭스.
- 조회수/좋아요/신고 카운팅 및 비밀글/공개 범위 제약, 게이트웨이/테넌트 필터와 일관된 보안 검증.
- 프런트엔드에서 API 연동, 에러 처리, optimistic UI 대응 및 테스트 케이스 작성.

## 4. 자료실(파일 저장소) 서비스

### 구현 현황
- `backend/file-service/src/main/java/com/roimsg/file/controller/FileController.java` 는 단일 파일 업로드/다운로드/삭제 및 전체 목록 조회를 제공한다.
- 업로드 시 확장자 차단 목록 검증, 저장 경로 생성, `StoredFile` 엔티티 저장까지는 구현되어 있다.
- 프런트엔드 `frontend/web-app/src/views/files/*.vue` 는 파일 목록/업로드 UI를 제공하지만 현재는 더미 데이터와 로컬 상태로만 동작한다.

### 추가 구현 필요사항
- 업로드/다운로드 시 JWT·테넌트·업로더 검증을 적용하고, `tenant_id` 및 `uploader_id` 저장 누락을 해결하는 서버 측 로직 강화.
- 대용량/다중 파일 업로드, 이어 올리기(Resumable Upload), 압축 다운로드(Zip), 폴더/태그 분류, 버전 관리.
- 이미지/문서/PDF 미리보기, 비디오 스트리밍, 바이러스 검사/무해화(DLP), 콘텐츠 만료, 접근 추적.
- 저장소 이용량 모니터링, 테넌트·계정별 용량 제한, 보관 정책(자동 삭제/보관) 및 감사 로그 제공.
- 프런트엔드에서 실제 API 연동, 업로드 진행률/실패 처리, 권한에 따른 버튼 노출 제어 및 테스트 자동화.

## 5. 회원관리 서비스

### 구현 현황
- `backend/user-service/src/main/java/com/roimsg/user/controller/UserController.java` 는 사용자 목록 조회, 단건 조회, 생성, 수정, 삭제 API를 제공한다.
- `UserService` 는 이메일 검색과 기본 CRUD를 담당하며, `User` 엔티티는 프로필 이미지/연락처 등 확장 필드를 포함한다.
- 프런트엔드 `frontend/web-app/src/views/UsersView.vue` 는 사용자 테이블 UI가 존재하지만 정적 데이터에 의존하며 역할/권한 정보는 실제 데이터와 연계되지 않았다.

### 추가 구현 필요사항
- 모든 API에 테넌트 경계 검증(`X-Tenant-Id`, JWT) 적용, `UserRepository` 의 `findByIdAndTenantId` 활용 및 서비스 계층에서 강제.
- 역할/권한(Role/Permission) 모델, 관리자 위임, 그룹/부서 편성, 계정 상태(잠금/비활Active), 감사 로그/액티비티 트래킹.
- 초대장/비밀번호 초기화, 2FA, 프로필 커스터마이징, 알림 설정, 법적 동의(약관/개인정보) 관리.
- Auth 서비스와 사용자 서비스 간 데이터 정합성 확보(가입/탈퇴/비활성화 동기화, 이벤트 기반 연동).
- 프런트엔드에서 사용자 API 연동, 필터/검색, 일괄 작업(비활성/삭제), 상세 패널, 폼 검증 추가.

## 6. 공통 모듈 및 인프라

### 구현 현황
- `backend/common-starter/src/main/java/com/roimsg/common/web/ApiResponse.java` 와 `GlobalExceptionHandler` 로 공통 응답/에러 포맷이 정의되어 있다.
- `shared/src/index.ts` 는 테넌트 컨텍스트, 페이지네이션, API 응답 타입 등 공용 타입/유틸을 제공한다.
- API 게이트웨이는 JWT 필터, 보안 헤더, Redis 기반 Rate Limiting 필터가 구성되어 있다.

### 추가 구현 필요사항
- 공통 로깅/트레이싱/모니터링(AOP 기반 요청/응답 로깅, MSA 간 상관관계 ID), 감사(Audit) 프레임워크 및 장애 알림.
- 멀티테넌시 지원을 위한 Spring `TenantContext`→JPA 자동 주입(AuditorAware, Hibernate Multi-Tenancy Strategy)과 테스트 커버리지.
- 에러 코드 표준화, 다국어 메시지, Validation Response 일관성, API 문서화(Swagger/OpenAPI) 자동화 및 샘플 요청/응답 제공.
- 테스트 전략 정비: 단위·통합·계약 테스트, 테스트 데이터 분리, CI 파이프라인 통합.
- 공통 인증 모듈에서 토큰 블랙리스트, 세션 추적, OAuth 클라이언트 관리, 보안 정책(비밀번호 규칙, IP 제한) 도입.

---

위 목록을 기반으로 우선순위를 산정하고 로드맵에 반영하면, 각 서비스가 실제 운영 수준으로 확장되기 위한 준비가 가능하다. 필요 시 세부 설계서(ERD, API 명세, UI 와이어프레임)를 추가로 작성해 연계 개발을 진행한다.
